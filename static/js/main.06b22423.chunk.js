(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{10:function(e,t,n){e.exports=n(16)},15:function(e,t,n){},16:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(7),i=n.n(o),s=(n(15),n(9)),c=n(1),l=n(8),u=n.n(l),m=function(){return r.a.createElement("header",{className:"header"},r.a.createElement("a",{href:"https://ss.metronews.ru/userfiles/materials/60/605363/858x429.jpg",className:"header__logo"},r.a.createElement("img",{src:u.a,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f Mesto Russia"})))},d=function(){return r.a.createElement("footer",{className:"footer"},r.a.createElement("p",{className:"footer__copyright"},"\xa9 2020 Mesto Russia"))},f=function(e){var t=e.card,n=e.onClose,a=e.onEscPress,o="popup popup_content_figure image-popup ".concat(t&&"popup_opened"),i=r.a.useRef("");return r.a.useEffect((function(){return t&&document.addEventListener("keydown",a),i.current=t&&t.link,function(){t&&document.removeEventListener("keydown",a)}}),[t,a]),r.a.createElement("section",{className:o,onClick:n},r.a.createElement("figure",{className:"figure popup__container",onClick:function(e){return e.stopPropagation()}},r.a.createElement("button",{className:"close-btn figure__close-btn",type:"button",onClick:n,"aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u043f\u043e\u043f\u0430\u043f"}),r.a.createElement("img",{className:"figure__image",src:t&&t.link||i.current,alt:t&&t.name}),r.a.createElement("figcaption",{className:"figure__caption"},t&&t.name)))},p=r.a.createContext(),_=function(e){var t=e.card,n=e.onCardClick,o=e.onCardLike,i=e.onCardDelete,s=Object(a.useContext)(p),c=t.owner._id===s._id,l=t.likes.some((function(e){return e._id===s._id})),u="card__like-btn ".concat(l&&"card__like-btn_enabled"),m="card__trash-btn ".concat(c&&"card__trash-btn_enabled");return r.a.createElement("li",{className:"card"},r.a.createElement("button",{className:m,"aria-label":"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443 \u0441 \u043f\u043e\u0434\u043f\u0438\u0441\u044c\u044e",type:"button",name:"trash",onClick:function(){i(t)}}),r.a.createElement("img",{className:"card__image",src:t.link,alt:t.name,onClick:function(){n(t)}}),r.a.createElement("div",{className:"card__caption"},r.a.createElement("h2",{className:"card__title"},t.name),r.a.createElement("div",{className:"card__like-block"},r.a.createElement("button",{className:u,type:"button",name:"like",onClick:function(){o(t)},"aria-label":"\u041f\u043e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u043b\u0430\u0439\u043a \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0435"}),r.a.createElement("p",{className:"card__like-numbers"},t.likes.length||""))))},h=function(e){var t=e.name,n=e.isOpen,o=e.title,i=e.submitBtnLoadingText,s=e.submitBtnRegularText,l=e.onClose,u=e.onSubmit,m=e.onEscPress,d=e.children,f="popup popup_content_form ".concat(t,"-popup ").concat(n&&"popup_opened"),p=Object(a.useState)(!1),_=Object(c.a)(p,2),h=_[0],E=_[1];Object(a.useEffect)((function(){return n&&document.addEventListener("keydown",m),function(){n&&document.removeEventListener("keydown",m)}}),[n,m]);return r.a.createElement("section",{className:f,onClick:l},r.a.createElement("form",{className:"form popup__container form-to-validate",name:t,onSubmit:function(e){E(!0),u(e).finally((function(){E(!1)}))},onClick:function(e){return e.stopPropagation()},noValidate:!0},r.a.createElement("h3",{className:"form__title"}," ",o," "),r.a.createElement("button",{className:"close-btn form__close-btn",type:"reset",name:"close",onClick:l,"aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u043f\u043e\u043f\u0430\u043f"}),d,r.a.createElement("button",{className:"form__submit-btn",type:"submit"},h?i:s)))},E=function(e){var t=e.isOpen,n=e.onClose,o=e.onUpdateUser,i=e.onEscPress,s=Object(a.useContext)(p),l=Object(a.useState)(" "),u=Object(c.a)(l,2),m=u[0],d=u[1],f=Object(a.useState)(" "),_=Object(c.a)(f,2),E=_[0],b=_[1];return Object(a.useEffect)((function(){t&&d(s.name),t&&b(s.about)}),[t,s.name,s.about]),r.a.createElement(h,{name:"edit-profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",isOpen:t,onClose:n,onSubmit:function(e){return e.preventDefault(),o({name:m,about:E})},submitBtnLoadingText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435",submitBtnRegularText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",onEscPress:i},r.a.createElement("div",{className:"form__field"},r.a.createElement("input",{className:"form__input",id:"profile-name",type:"text",name:"profile-name",placeholder:"\u0418\u043c\u044f",required:!0,minLength:"2",maxLength:"40",value:m,onChange:function(e){d(e.target.value)}}),r.a.createElement("span",{className:"form__input-error form__input-error_origin_profile-name"})),r.a.createElement("div",{className:"form__field"},r.a.createElement("input",{className:"form__input",id:"profile-description",type:"text",name:"profile-description",placeholder:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",required:!0,minLength:"2",maxLength:"200",value:E,onChange:function(e){b(e.target.value)}}),r.a.createElement("span",{className:"form__input-error form__input-error_origin_profile-description"})))},b=function(e){var t=e.isOpen,n=e.onClose,o=e.onUpdateAvatar,i=e.onEscPress,s=Object(a.useContext)(p),c=Object(a.useRef)();return r.a.createElement(h,{name:"update-avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",isOpen:t,onClose:n,onSubmit:function(e){return e.preventDefault(),o({avatar:c.current.value})},submitBtnLoadingText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435",submitBtnRegularText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",onEscPress:i},r.a.createElement("div",{className:"form__field"},r.a.createElement("input",{ref:c,defaultValue:s.avatar,className:"form__input",id:"avatar-link",type:"url",name:"avatar-link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0}),r.a.createElement("span",{className:"form__input-error form__input-error_origin_avatar-link"})))},v=function(e){var t=e.isOpen,n=e.onClose,o=e.onUpdateCards,i=e.onEscPress,s=Object(a.useState)(""),l=Object(c.a)(s,2),u=l[0],m=l[1],d=Object(a.useState)(""),f=Object(c.a)(d,2),p=f[0],_=f[1];return Object(a.useEffect)((function(){t&&(m(""),_(""))}),[t]),r.a.createElement(h,{name:"add-card",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",isOpen:t,onClose:n,submitBtnLoadingText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435",submitBtnRegularText:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",onSubmit:function(e){return e.preventDefault(),o({name:u,link:p})},onEscPress:i},r.a.createElement("div",{className:"form__field"},r.a.createElement("input",{onChange:function(e){m(e.target.value)},value:u,className:"form__input",id:"card-name",type:"text",name:"card-name",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",required:!0,minLength:"1",maxLength:"30"}),r.a.createElement("span",{className:"form__input-error form__input-error_origin_card-name"})),r.a.createElement("div",{className:"form__field"},r.a.createElement("input",{onChange:function(e){_(e.target.value)},value:p,className:"form__input",id:"card-link",type:"url",name:"card-link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0}),r.a.createElement("span",{className:"form__input-error form__input-error_origin_card-link"})))},C=function(e){var t=e.onEditProfile,n=e.onAddPlace,o=e.onEditAvatar,i=e.closeAllPopups,s=e.onCardClick,c=e.onUpdateUser,l=e.onUpdateAvatar,u=e.onCardLike,m=e.onCardDelete,d=e.onUpdateCards,h=e.onEscPress,C=e.onOverlayClick,k=e.isEditProfilePopupOpen,g=e.isEditAvatarPopupOpen,O=e.isAddPlacePopupOpen,y=e.selectedCard,N=e.cards,S=Object(a.useContext)(p);return r.a.createElement("main",{className:"content"},r.a.createElement("section",{className:"profile"},r.a.createElement("div",{className:"profile__content"},r.a.createElement("img",{src:S.avatar,className:"profile__avatar",alt:"\u0444\u043e\u0442\u043e ".concat(S.name),onClick:o}),r.a.createElement("div",{className:"profile__info"},r.a.createElement("div",{className:"profile__title-block"},r.a.createElement("h1",{className:"profile__name"},S.name),r.a.createElement("button",{className:"profile__edit-btn",type:"button",onClick:t,"aria-label":"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c"})),r.a.createElement("p",{className:"profile__description"},S.about))),r.a.createElement("button",{className:"add-btn",type:"button",onClick:n,"aria-label":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043c\u0435\u0441\u0442\u043e"})),r.a.createElement("section",{className:"cards"},r.a.createElement("ul",{className:"cards__container"},N.map((function(e){return r.a.createElement(_,{card:e,onCardClick:s,key:e._id,onCardLike:u,onCardDelete:m})})))),r.a.createElement(b,{isOpen:g,onClose:i,onUpdateAvatar:l,onEscPress:h,onOverlayClick:C}),r.a.createElement(E,{isOpen:k,onClose:i,onUpdateUser:c,onEscPress:h,onOverlayClick:C}),r.a.createElement(f,{card:y,onClose:i,onEscPress:h,onOverlayClick:C}),r.a.createElement(v,{isOpen:O,onClose:i,onUpdateCards:d,onEscPress:h,onOverlayClick:C}))},k=n(4),g=n(5),O=new(function(){function e(t){var n=this,a=t.baseUrl,r=t.headers;Object(k.a)(this,e),this.changeLikeCardStatus=function(e,t){return t?n.unlikeCard(e):n.likeCard(e)},this._baseUrl=a,this._headers=r}return Object(g.a)(e,[{key:"_handleOriginalResponse",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}},{key:"getInitialCards",value:function(){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers}).then(this._handleOriginalResponse)}},{key:"getUserInfo",value:function(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then(this._handleOriginalResponse)}},{key:"setUserInfo",value:function(e){return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._handleOriginalResponse)}},{key:"setAvatar",value:function(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._handleOriginalResponse)}},{key:"postCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify(e)}).then(this._handleOriginalResponse)}},{key:"deleteCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then(this._handleOriginalResponse)}},{key:"likeCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers}).then(this._handleOriginalResponse)}},{key:"unlikeCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers}).then(this._handleOriginalResponse)}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-14",headers:{authorization:"4925288f-4ad5-4bea-a0ab-09ab5e2fc610","Content-Type":"application/json"}}),y=function(){function e(t,n){Object(k.a)(this,e),this._inputList=Array.from(n.querySelectorAll(t.inputSelector)),this._submitBtnElement=n.querySelector(t.submitButtonSelector),this._inactiveBtnClass=t.inactiveButtonClass,this._activeInputErrorClass=t.activeInputErrorClass,this._inputErrorSelectorComponent=t.inputErrorSelectorComponent,this._formElement=n;var a=t.openBtnSelectors.find((function(e){return e.formName===n.name})).openBtnSelector;this._formOpenBtn=document.querySelector(a)}return Object(g.a)(e,[{key:"_getErrorElement",value:function(e){var t="".concat(this._inputErrorSelectorComponent).concat(e.id);return this._formElement.querySelector(t)}},{key:"_showError",value:function(e,t){var n=this._getErrorElement(e);n.textContent=t,n.classList.add(this._activeInputErrorClass)}},{key:"_hideError",value:function(e){var t=this._getErrorElement(e);t.classList.remove(this._activeInputErrorClass),t.textContent=""}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideError(e):this._showError(e,e.validationMessage)}},{key:"_hasInvalidInput",value:function(){return this._inputList.some((function(e){return!e.validity.valid}))}},{key:"_setFormListeners",value:function(){var e=this;this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(t),e._setButtonState(e._submitBtnElement)}))}))}},{key:"_disableElement",value:function(e){e.classList.add(this._inactiveBtnClass),e.hasAttribute("disabled")||e.setAttribute("disabled",!0)}},{key:"_enableElement",value:function(e){e.classList.remove(this._inactiveBtnClass),e.hasAttribute("disabled")&&e.removeAttribute("disabled")}},{key:"_setButtonState",value:function(e){this._hasInvalidInput()?this._disableElement(e):this._enableElement(e)}},{key:"_checkFormValidity",value:function(){var e=this;this._inputList.forEach((function(t){e._checkInputValidity(t)})),this._setButtonState(this._submitBtnElement)}},{key:"enableValidation",value:function(){var e=this;this._setFormListeners(),this._formOpenBtn.addEventListener("click",(function(){e._checkFormValidity()}))}}]),e}(),N={inputSelector:".form__input",submitButtonSelector:".form__submit-btn",inactiveButtonClass:"form__submit-btn_disabled",inputErrorClass:"form__input-error",activeInputErrorClass:"form__input-error_active",inputErrorSelectorComponent:".form__input-error_origin_",openBtnSelectors:[{formName:"edit-profile",openBtnSelector:".profile__edit-btn"},{formName:"add-card",openBtnSelector:".add-btn"},{formName:"update-avatar",openBtnSelector:".profile__avatar"}]};var S=function(){var e=Object(a.useState)(!1),t=Object(c.a)(e,2),n=t[0],o=t[1],i=Object(a.useState)(!1),l=Object(c.a)(i,2),u=l[0],f=l[1],_=Object(a.useState)(!1),h=Object(c.a)(_,2),E=h[0],b=h[1],v=Object(a.useState)(null),k=Object(c.a)(v,2),g=k[0],S=k[1],j=Object(a.useState)({}),P=Object(c.a)(j,2),L=P[0],U=P[1],B=Object(a.useState)([]),A=Object(c.a)(B,2),x=A[0],I=A[1];Object(a.useEffect)((function(){Promise.all([O.getUserInfo(),O.getInitialCards()]).then((function(e){var t=Object(c.a)(e,2),n=t[0],a=t[1];U(n),I(a)})).catch((function(e){console.log(e)}))}),[]),Object(a.useEffect)((function(){var e;e=N,Array.from(document.querySelectorAll(".form-to-validate")).forEach((function(t){new y(e,t).enableValidation()}))}),[]);var w=function(){n&&o(!1),u&&f(!1),E&&b(!1),g&&S(null)};return r.a.createElement(p.Provider,{value:L},r.a.createElement("div",{className:"page"},r.a.createElement("div",{className:"page__container"},r.a.createElement(m,null),r.a.createElement(C,{onEditProfile:function(){o(!0)},onAddPlace:function(){b(!0)},onEditAvatar:function(){f(!0)},closeAllPopups:w,onCardClick:function(e){S(e)},onUpdateUser:function(e){return O.setUserInfo(e).then((function(e){U(e)})).catch((function(e){console.log(e)})).finally((function(){w()}))},onUpdateAvatar:function(e){return O.setAvatar(e).then((function(e){U(e)})).catch((function(e){console.log(e)})).finally((function(){w()}))},onCardLike:function(e){var t=e.likes.some((function(e){return e._id===L._id}));O.changeLikeCardStatus(e._id,t).then((function(t){var n=x.map((function(n){return n._id===e._id?t:n}));I(n)})).catch((function(e){console.log(e)}))},onCardDelete:function(e){O.deleteCard(e._id).then((function(){var t=x.findIndex((function(t){return t._id===e._id})),n=x.slice();n.splice(t,1),I(n)})).catch((function(e){console.log(e)}))},onUpdateCards:function(e){return O.postCard(e).then((function(e){I([e].concat(Object(s.a)(x)))})).catch((function(e){console.log(e)})).finally((function(){w()}))},onEscPress:function(e){"Escape"===e.key&&w()},isEditProfilePopupOpen:n,isEditAvatarPopupOpen:u,isAddPlacePopupOpen:E,selectedCard:g,cards:x}),r.a.createElement(d,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(S,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},8:function(e,t,n){e.exports=n.p+"static/media/mesto-russia-logo.a347391f.svg"}},[[10,1,2]]]);
//# sourceMappingURL=main.06b22423.chunk.js.map