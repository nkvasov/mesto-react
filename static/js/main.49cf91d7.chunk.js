(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{10:function(e,t,a){e.exports=a(16)},15:function(e,t,a){},16:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(7),c=a.n(o),s=(a(15),a(9)),i=a(1),l=a(8),u=a.n(l),m=function(){return r.a.createElement("header",{className:"header"},r.a.createElement("a",{href:"https://ss.metronews.ru/userfiles/materials/60/605363/858x429.jpg",className:"header__logo"},r.a.createElement("img",{src:u.a,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f Mesto Russia"})))},d=function(){return r.a.createElement("footer",{className:"footer"},r.a.createElement("p",{className:"footer__copyright"},"\xa9 2020 Mesto Russia"))},p=function(e){var t=e.name,a=e.isOpen,n=e.title,o=e.onClose,c=e.submitBtnText,s=e.onSubmit,i=e.onEscPress,l=e.onOverlayClick,u=e.children,m="popup popup_content_form ".concat(t,"-popup ").concat(a&&"popup_opened");return r.a.useEffect((function(){return a&&document.addEventListener("keydown",i),function(){document.removeEventListener("keydown",i)}})),r.a.createElement("section",{className:m,onClick:l},r.a.createElement("form",{className:"form popup__container",name:t,onSubmit:s,noValidate:!0},r.a.createElement("h3",{className:"form__title"}," ",n," "),r.a.createElement("button",{className:"close-btn form__close-btn",type:"reset",name:"close",onClick:o,"aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u043f\u043e\u043f\u0430\u043f"}),u,r.a.createElement("button",{className:"form__submit-btn",type:"submit"},c)))},f=function(e){var t=e.card,a=e.onClose,n=e.onEscPress,o=e.onOverlayClick,c="popup popup_content_figure image-popup ".concat(t&&"popup_opened"),s=r.a.useRef("");return r.a.useEffect((function(){return t&&document.addEventListener("keydown",n),s.current=t&&t.link,function(){t&&document.removeEventListener("keydown",n)}})),r.a.createElement("section",{className:c,onClick:o},r.a.createElement("figure",{className:"figure popup__container"},r.a.createElement("button",{className:"close-btn figure__close-btn",type:"button",onClick:a,"aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u043f\u043e\u043f\u0430\u043f"}),r.a.createElement("img",{className:"figure__image",src:t&&t.link||s.current,alt:t&&t.name}),r.a.createElement("figcaption",{className:"figure__caption"},t&&t.name," ")))},_=r.a.createContext(),h=function(e){var t=e.card,a=e.onCardClick,o=e.onCardLike,c=e.onCardDelete,s=Object(n.useContext)(_),i=t.owner._id===s._id,l=t.likes.some((function(e){return e._id===s._id})),u="card__like-btn ".concat(l&&"card__like-btn_enabled"),m="card__trash-btn ".concat(i&&"card__trash-btn_enabled");return r.a.createElement("li",{className:"card"},r.a.createElement("button",{className:m,"aria-label":"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443 \u0441 \u043f\u043e\u0434\u043f\u0438\u0441\u044c\u044e",type:"button",name:"trash",onClick:function(){c(t)}}),r.a.createElement("img",{className:"card__image",src:t.link,alt:t.name,onClick:function(){a(t)}}),r.a.createElement("div",{className:"card__caption"},r.a.createElement("h2",{className:"card__title"},t.name),r.a.createElement("div",{className:"card__like-block"},r.a.createElement("button",{className:u,type:"button",name:"like",onClick:function(){o(t)},"aria-label":"\u041f\u043e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u043b\u0430\u0439\u043a \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0435"}),r.a.createElement("p",{className:"card__like-numbers"},t.likes.length||""))))},E=function(e){var t=e.isOpen,a=e.onClose,o=e.onUpdateUser,c=e.onEscPress,s=e.onOverlayClick,l=Object(n.useContext)(_),u=Object(n.useState)(l.name),m=Object(i.a)(u,2),d=m[0],f=m[1],h=Object(n.useState)(l.about),E=Object(i.a)(h,2),b=E[0],v=E[1];return Object(n.useEffect)((function(){t&&f(l.name),t&&v(l.about)}),[t,l.name,l.about]),r.a.createElement(p,{name:"edit-profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),o({name:d,about:b})},submitBtnText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",onEscPress:c,onOverlayClick:s},r.a.createElement("div",{className:"form__field"},r.a.createElement("input",{className:"form__input",id:"profile-name",type:"text",name:"profile-name",placeholder:"\u0418\u043c\u044f",required:!0,minLength:"2",maxLength:"40",value:d||"",onChange:function(e){f(e.target.value)}}),r.a.createElement("span",{className:"form__input-error form__input-error_origin_profile-name"})),r.a.createElement("div",{className:"form__field"},r.a.createElement("input",{className:"form__input",id:"profile-description",type:"text",name:"profile-description",placeholder:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",required:!0,minLength:"2",value:b||"",maxLength:"200",onChange:function(e){v(e.target.value)}}),r.a.createElement("span",{className:"form__input-error form__input-error_origin_profile-description"})))},b=function(e){var t=e.isOpen,a=e.onClose,o=e.onUpdateAvatar,c=e.onEscPress,s=e.onOverlayClick,i=Object(n.useContext)(_),l=Object(n.useRef)();return r.a.createElement(p,{name:"update-avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),o({avatar:l.current.value})},submitBtnText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",onEscPress:c,onOverlayClick:s},r.a.createElement("div",{className:"form__field"},r.a.createElement("input",{ref:l,defaultValue:i.avatar,className:"form__input",id:"avatar-link",type:"url",name:"avatar-link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0}),r.a.createElement("span",{className:"form__input-error form__input-error_origin_avatar-link"})))},v=function(e){var t=e.isOpen,a=e.onClose,o=e.onUpdateCards,c=e.onEscPress,s=e.onOverlayClick,l=Object(n.useState)(""),u=Object(i.a)(l,2),m=u[0],d=u[1],f=Object(n.useState)(""),_=Object(i.a)(f,2),h=_[0],E=_[1],b=function(){d(""),E("")};return Object(n.useEffect)((function(){t&&b()}),[t]),r.a.createElement(p,{name:"add-card",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",isOpen:t,onClose:a,submitBtnText:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",onSubmit:function(e){e.preventDefault(),o({name:m,link:h}),b()},onEscPress:c,onOverlayClick:s},r.a.createElement("div",{className:"form__field"},r.a.createElement("input",{onChange:function(e){d(e.target.value)},value:m,className:"form__input",id:"card-name",type:"text",name:"card-name",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",required:!0,minLength:"1",maxLength:"30"}),r.a.createElement("span",{className:"form__input-error form__input-error_origin_card-name"})),r.a.createElement("div",{className:"form__field"},r.a.createElement("input",{onChange:function(e){E(e.target.value)},value:h,className:"form__input",id:"card-link",type:"url",name:"card-link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0}),r.a.createElement("span",{className:"form__input-error form__input-error_origin_card-link"})))},C=function(e){var t=e.onEditProfile,a=e.onAddPlace,o=e.onEditAvatar,c=e.closeAllPopups,s=e.onCardClick,i=e.onUpdateUser,l=e.onUpdateAvatar,u=e.onCardLike,m=e.onCardDelete,d=e.onUpdateCards,C=e.onEscPress,k=e.onOverlayClick,O=e.isEditProfilePopupOpen,g=e.isEditAvatarPopupOpen,N=e.isAddPlacePopupOpen,y=e.selectedCard,P=e.cards,j=Object(n.useContext)(_);return r.a.createElement("main",{className:"content"},r.a.createElement("section",{className:"profile"},r.a.createElement("div",{className:"profile__content"},r.a.createElement("img",{src:j.avatar,className:"profile__avatar",alt:"\u0444\u043e\u0442\u043e ".concat(j.name),onClick:o}),r.a.createElement("div",{className:"profile__info"},r.a.createElement("div",{className:"profile__title-block"},r.a.createElement("h1",{className:"profile__name"},j.name),r.a.createElement("button",{className:"profile__edit-btn",type:"button",onClick:t,"aria-label":"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c"})),r.a.createElement("p",{className:"profile__description"},j.about))),r.a.createElement("button",{className:"add-btn",type:"button",onClick:a,"aria-label":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043c\u0435\u0441\u0442\u043e"})),r.a.createElement("section",{className:"cards"},r.a.createElement("ul",{className:"cards__container"},P.map((function(e){return r.a.createElement(h,{card:e,onCardClick:s,key:e._id,onCardLike:u,onCardDelete:m})})))),r.a.createElement(p,{name:"confirmation",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",onClose:c,submitBtnText:"\u0414\u0430"}),r.a.createElement(b,{isOpen:g,onClose:c,onUpdateAvatar:l,onEscPress:C,onOverlayClick:k}),r.a.createElement(E,{isOpen:O,onClose:c,onUpdateUser:i,onEscPress:C,onOverlayClick:k}),r.a.createElement(f,{card:y,onClose:c,onEscPress:C,onOverlayClick:k}),r.a.createElement(v,{isOpen:N,onClose:c,onUpdateCards:d,onEscPress:C,onOverlayClick:k}))},k=a(4),O=a(5),g=new(function(){function e(t){var a=this,n=t.baseUrl,r=t.headers;Object(k.a)(this,e),this.changeLikeCardStatus=function(e,t){return t?a.unlikeCard(e):a.likeCard(e)},this._baseUrl=n,this._headers=r}return Object(O.a)(e,[{key:"_handleOriginalResponse",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}},{key:"getInitialCards",value:function(){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers}).then(this._handleOriginalResponse)}},{key:"getUserInfo",value:function(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then(this._handleOriginalResponse)}},{key:"setUserInfo",value:function(e){return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._handleOriginalResponse)}},{key:"setAvatar",value:function(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._handleOriginalResponse)}},{key:"postCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify(e)}).then(this._handleOriginalResponse)}},{key:"deleteCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then(this._handleOriginalResponse)}},{key:"likeCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers}).then(this._handleOriginalResponse)}},{key:"unlikeCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers}).then(this._handleOriginalResponse)}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-14",headers:{authorization:"4925288f-4ad5-4bea-a0ab-09ab5e2fc610","Content-Type":"application/json"}});var N=function(){var e=Object(n.useState)(!1),t=Object(i.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)(!1),l=Object(i.a)(c,2),u=l[0],p=l[1],f=Object(n.useState)(!1),h=Object(i.a)(f,2),E=h[0],b=h[1],v=Object(n.useState)(),k=Object(i.a)(v,2),O=k[0],N=k[1],y=Object(n.useState)({}),P=Object(i.a)(y,2),j=P[0],U=P[1],S=Object(n.useState)([]),x=Object(i.a)(S,2),A=x[0],L=x[1];Object(n.useEffect)((function(){Promise.all([g.getUserInfo(),g.getInitialCards()]).then((function(e){var t=Object(i.a)(e,2),a=t[0],n=t[1];U(a),L(n)})).catch((function(e){console.log(e)}))}),[]);var w=function(){a&&o(!1),u&&p(!1),E&&b(!1),O&&N()};return r.a.createElement(_.Provider,{value:j},r.a.createElement("div",{className:"page"},r.a.createElement("div",{className:"page__container"},r.a.createElement(m,null),r.a.createElement(C,{onEditProfile:function(){o(!0)},onAddPlace:function(){b(!0)},onEditAvatar:function(){p(!0)},closeAllPopups:w,onCardClick:function(e){N(e)},onUpdateUser:function(e){g.setUserInfo(e).then((function(e){U(e)})).then((function(){w()})).catch((function(e){console.log(e)}))},onUpdateAvatar:function(e){g.setAvatar(e).then((function(e){U(e)})).then((function(){w()})).catch((function(e){console.log(e)}))},onCardLike:function(e){var t=e.likes.some((function(e){return e._id===j._id}));g.changeLikeCardStatus(e._id,t).then((function(t){var a=A.map((function(a){return a._id===e._id?t:a}));L(a)})).catch((function(e){console.log(e)}))},onCardDelete:function(e){g.deleteCard(e._id).then((function(){var t=A.findIndex((function(t){return t._id===e._id})),a=A.slice();a.splice(t,1),L(a)})).catch((function(e){console.log(e)}))},onUpdateCards:function(e){g.postCard(e).then((function(e){L([e].concat(Object(s.a)(A)))})).then((function(){w()})).catch((function(e){console.log(e)}))},onEscPress:function(e){"Escape"===e.key&&w()},onOverlayClick:function(e){e.currentTarget===e.target&&w()},isEditProfilePopupOpen:a,isEditAvatarPopupOpen:u,isAddPlacePopupOpen:E,selectedCard:O,cards:A}),r.a.createElement(d,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(N,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},8:function(e,t,a){e.exports=a.p+"static/media/mesto-russia-logo.a347391f.svg"}},[[10,1,2]]]);
//# sourceMappingURL=main.49cf91d7.chunk.js.map